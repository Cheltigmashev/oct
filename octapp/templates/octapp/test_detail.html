{% extends 'octapp/base.html' %}
{% load staticfiles %}

{% block page_style %}
<link rel="stylesheet" href="">
{% endblock %}

{% block content %}
<h2>ТЕСТ <q>{{ test.name|upper }}</q></h2>

    {% if not test.anonymous_loader %}
<h3 class="text-left">Данный тест загрузил пользователь {{ test.author }}</h3>
    {% else %}
<h3 class="text-left">Данный тест добавлен в систему анонимно</h3>
    {% endif %}

    {% if test.category %}
<h3 class="text-left">Категория теста — <q>{{ test.category }}</q></h3>
    {% else %}
<h3 class="text-left">Данному тесту не присвоена категория</h3>
    {% endif %}

<h3 class="text-left">Описание теста</h3>
{{ test.description|safe }}

    {% if test.controlling %}
<h3 class="text-left">Для данного теста задано использование контроля прохождения</h3>
    {% else %}
<h3 class="text-left">Для данного теста не задано использование контроля прохождения</h3>    
    {% endif %}

    {% if test.time_restricting %}
<h3 class="text-left">Для данного теста установлено ограничение времени прохождения</h3>
    {% else %}
<h3 class="text-left">Это тест без ограничения на время прохождения</h3>    
    {% endif %}

<h3 class="text-left">Рейтинг теста: {{ test.rating }}</h3>

<h3 class="text-left">Дата добавления теста в систему — {{ test.created_date }}</h3>

    {% if test.published_date %}
<h3 class="text-left">Дата публикации — {{ test.published_date }}</h3>
    {% else %}
    <h3 class="text-left">Данный тест еще не опубликован 
        {% if test.author %}
        пользователем {{ test.author }}</h3>
        {% else %}
        анонимным пользователем</h3>
        {% endif %}
    {% endif %}

<h3 class="text-left">Теги теста:
    {% for tag in test.tags.all %}
        {% if forloop.last %}
{{ tag }}</span></h3>
        {% else %}
{{ tag }}, </span>
        {% endif %}
    {% empty %}
<p>Для данного теста какие-либо теги не назначены 
        {% if test.author %}
    пользователем {{ test.author }}
        {% else %}
    анонимным пользователем
        {% endif %}
    , который добавил данный тест :(</p>
    {% endfor %}
    <br>
    <a href="{% url 'test_detail' pk=test.pk %}" class="btn btn-default btn-lg">Приступить к прохождению теста</a>

    {% if is_author or request.user.is_superuser or perms.octapp.test.can_change %}
<hr><h2>Управление тестом</h2>

        {% if is_author %}
    Вам, как тому, кто загрузил данный тест, доступны возможности:<br>
            {% if not test.published_date %}
    <a href="{% url 'test_publish' pk=test.pk %}" class="btn btn-default btn-lg">Опубликовать тест</a>
            {% endif %}
    <a href="{% url 'test_remove' pk=test.pk %}" class="btn btn-danger btn-lg">Удалить тест</a>
    <a href="{% url 'test_edit' pk=test.pk %}" class="btn btn-info btn-lg">Изменить вышепредставленные данные теста</a>
    <a href="" class="btn btn-default btn-lg">Добавить к тесту новый вопрос</a>
        {% endif %}
    
        {% if not is_author and perms.octapp.test.can_change and not request.user.is_superuser %}
    Вы не автор теста, но вы относитесь к модераторам, поэтому вам доступен данный функционал:<br>
    <a href="{% url 'test_edit' pk=test.pk %}" class="btn btn-default btn-lg">Изменить вышепредставленные данные теста</a>
        {% endif %}

        {% if not is_author and request.user.is_superuser %}
    Вы не автор теста, но являетесь суперпользователем, поэтому вам также доступен данный функционал:<br>
    <a href="{% url 'test_edit' pk=test.pk %}" class="btn btn-default btn-lg">Изменить вышепредставленные данные теста</a>
    <a href="{% url 'test_remove' pk=test.pk %}" class="btn btn-danger btn-lg">Удалить тест</a>
        {% endif %}

        {% if user.is_authenticated %}
    <br>Если вам понравился тест, то вы можете:<br>
    <a href="{% url 'test_detail' pk=test.pk %}" class="btn btn-default btn-lg">Оценить его отрицательно — уменьшить рейтинг данного теста на 1</a>
    <a href="{% url 'test_detail' pk=test.pk %}" class="btn btn-default btn-lg">Оценить его положительно — увеличить рейтинг данного теста на 1</a>
        {% endif %}

    {% endif %}


{% endblock %}
